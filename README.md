# Архитектура и структура проекта

Проект переработан с упором на принципы чистой архитектуры, SOLID и строгую доменную модель.  
Цель — сделать код понятным, расширяемым и удобным для сопровождения.

---

## Основные архитектурные принципы

### Принцип единственной ответственности (SRP)

Монолитная логика разделена на отдельные классы.  
Каждый класс отвечает только за одну зону ответственности.

* **OrderProcessor** — обработка бизнес-логики заказов
* **OrderDetails** — хранение и валидация данных заказа
* **IProductRepository** — абстракция для работы с продуктами
* **IOrderRepository** — абстракция для работы с заказами
* **ProductRepository** — реализация `IProductRepository`
* **OrderRepository** — реализация `IOrderRepository`

Преимущества такого подхода:

* упрощение тестирования
* снижение связности компонентов
* повышение читаемости и поддерживаемости кода

---

## Типы предметной области (Domain Types)

Вместо примитивных типов (`string`, `int`) используются специализированные структуры, отражающие предметную область.

### Идентификаторы

* `OrderId` — идентификатор заказа
* `CustomerId` — идентификатор клиента
* `ProductId` — идентификатор продукта

### Значения с бизнес-валидацией

* `CustomerName` — имя клиента
* `DeliveryAddress` — адрес доставки

Валидация выполняется в конструкторах, что гарантирует корректное состояние объектов на протяжении всего жизненного цикла.

---

## Обработка ошибок

В проекте реализован единый и безопасный подход к обработке ошибок.

* создано пользовательское исключение `OrderProcessingException`
* полностью устранено использование строковых статусов
* исключения содержат контекстную информацию об ошибках

---

## Инкапсуляция и безопасность данных

Для повышения надёжности системы применены следующие решения:

* все поля классов сделаны приватными
* используются свойства только для чтения
* объекты всегда находятся в валидном состоянии

---

## Устранение дублирования кода

В ходе рефакторинга были выполнены следующие улучшения:

* валидация вынесена в отдельные методы
* проверка дубликатов продуктов реализована через `HashSet`
* удалены вложенные циклы
* логика вычислений изолирована в отдельных методах

---

## Структура проекта

### Основные классы

#### OrderProcessor

Основной класс для обработки заказов.

Методы:

* `ProcessOrder(OrderDetails orderDetails)` — обработка и сохранение заказа
* `GetOrderInformation(OrderId orderId)` — получение информации о заказе

---

#### OrderDetails

Контейнер для данных заказа.

Особенности:

* автоматическая валидация при создании
* проверка на дубликаты продуктов

---

### Value Objects

* `OrderId`
* `CustomerId`
* `ProductId`
* `CustomerName`
* `DeliveryAddress`

---

### Репозитории

Абстракции:

* `IProductRepository` — получение цен и данных продуктов
* `IOrderRepository` — сохранение и получение заказов

Реализации:

* `ProductRepository`
* `OrderRepository`

---

### Фабрика

* `OrderProcessorFactory` — фабрика для создания `OrderProcessor` с необходимыми зависимостями

---

## Итог

В результате рефакторинга проект получил:

* чёткую архитектуру
* выразительную доменную модель
* безопасную валидацию данных
* упрощённое тестирование
* готовность к расширению и масштабированию
